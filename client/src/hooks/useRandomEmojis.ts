// client\src\hooks\useRandomEmojis.ts
'use client'

import { useState, useEffect } from 'react'
import * as emoji from 'node-emoji'

export function generateRandomEmojis(count: number): string {
  const blockedSkinToneRegex = /[\u{1F3FB}-\u{1F3FF}]/u

  const blockedEmojis = new Set<string>([
    'ğŸ’Ÿ',
    'â˜®ï¸',
    'âœï¸',
    'â˜ªï¸',
    'ğŸª¯',
    'ğŸ•‰',
    'â˜¸ï¸',
    'âœ¡ï¸',
    'ğŸ”¯',
    'ğŸ•',
    'â˜¯ï¸',
    'â˜¦ï¸',
    'ğŸ›',
    'â›',
    'â™ˆï¸',
    'â™‰ï¸',
    'â™Šï¸',
    'â™‹ï¸',
    'â™Œï¸',
    'â™ï¸',
    'â™ï¸',
    'â™ï¸',
    'â™ï¸',
    'â™‘ï¸',
    'â™’ï¸',
    'â™“ï¸',
    'ğŸ†”',
    'âš›ï¸',
    'ğŸ‰‘',
    'â˜¢ï¸',
    'â˜£ï¸',
    'ğŸ“´',
    'ğŸ“³',
    'ğŸˆ¶',
    'ğŸˆšï¸',
    'ğŸˆ¸',
    'ğŸˆº',
    'ğŸˆ·ï¸',
    'âœ´ï¸',
    'ğŸ†š',
    'ğŸ‰',
    'ãŠ™ï¸',
    'ãŠ—ï¸',
    'ğŸˆ´',
    'ğŸˆµ',
    'ğŸˆ¹',
    'ğŸˆ²',
    'ğŸ…°ï¸',
    'ğŸ…±ï¸',
    'ğŸ†',
    'ğŸ†‘',
    'ğŸ…¾ï¸',
    'ğŸ†˜',
    'âŒ',
    'â­•ï¸',
    'ğŸ›‘',
    'â›”ï¸',
    'ğŸ“›',
    'ğŸš«',
    'ğŸ’¢',
    'â™¨ï¸',
    'ğŸš·',
    'ğŸš¯',
    'ğŸš³',
    'ğŸš±',
    'ğŸ”',
    'ğŸ“µ',
    'ğŸš­',
    'â—ï¸',
    'â•',
    'â“',
    'â”',
    'â€¼ï¸',
    'â‰ï¸',
    'ã€½ï¸',
    'âš ï¸',
    'ğŸš¸',
    'âœ…',
    'ğŸˆ¯ï¸',
    'ğŸ’¹',
    'â‡ï¸',
    'âœ³ï¸',
    'â',
    'â“‚ï¸',
    'ğŸ§',
    'ğŸš¾',
    'â™¿ï¸',
    'ğŸ…¿ï¸',
    'ğŸ›—',
    'ğŸˆ³',
    'ğŸˆ‚ï¸',
    'ğŸ›‚',
    'ğŸ›ƒ',
    'ğŸ›„',
    'ğŸ›…',
    'ğŸš¹',
    'ğŸšº',
    'ğŸš¼',
    'âš§',
    'ğŸš»',
    'ğŸš®',
    'ğŸ¦',
    'ğŸ›œ',
    'ğŸ“¶',
    'ğŸˆ',
    'ğŸ”£',
    'â„¹ï¸',
    'ğŸ”¤',
    'ğŸ”¡',
    'ğŸ” ',
    'ğŸ†–',
    'ğŸ†—',
    'ğŸ†™',
    'ğŸ†’',
    'ğŸ†•',
    'ğŸ†“',
    '0ï¸âƒ£',
    '1ï¸âƒ£',
    '2ï¸âƒ£',
    '3ï¸âƒ£',
    '4ï¸âƒ£',
    '5ï¸âƒ£',
    '6ï¸âƒ£',
    '7ï¸âƒ£',
    '8ï¸âƒ£',
    '9ï¸âƒ£',
    'ğŸ”Ÿ',
    'ğŸ”¢',
    '#ï¸âƒ£',
    '*ï¸âƒ£',
    'âï¸',
    'â–¶ï¸',
    'â¸',
    'â¯',
    'â¹',
    'âº',
    'â­',
    'â®',
    'â©',
    'âª',
    'â«',
    'â¬',
    'â—€ï¸',
    'ğŸ”¼',
    'ğŸ”½',
    'â¡ï¸',
    'â¬…ï¸',
    'â¬†ï¸',
    'â¬‡ï¸',
    'â†—ï¸',
    'â†˜ï¸',
    'â†™ï¸',
    'â†–ï¸',
    'â†•ï¸',
    'â†”ï¸',
    'â†ªï¸',
    'â†©ï¸',
    'â¤´ï¸',
    'â¤µï¸',
    'ğŸ”€',
    'ğŸ”',
    'ğŸ”‚',
    'ğŸ”„',
    'ğŸ”ƒ',
    'â•',
    'â–',
    'â—',
    'âœ–ï¸',
    'ğŸŸ°',
    'â„¢ï¸',
    'Â©ï¸',
    'Â®ï¸',
    'ğŸ”š',
    'ğŸ”™',
    'ğŸ”›',
    'ğŸ”',
    'ğŸ”œ',
    'âœ”ï¸',
    'â˜‘ï¸',
    'ğŸ”˜',
    'ğŸ”´',
    'ğŸŸ ',
    'ğŸŸ¡',
    'ğŸŸ¢',
    'ğŸ”µ',
    'ğŸŸ£',
    'âš«ï¸',
    'âšªï¸',
    'ğŸŸ¤',
    'ğŸ”º',
    'ğŸ”»',
    'ğŸ”¸',
    'ğŸ”¹',
    'ğŸ”¶',
    'ğŸ”·',
    'ğŸ”³',
    'ğŸ”²',
    'â–ªï¸',
    'â–«ï¸',
    'â—¾ï¸',
    'â—½ï¸',
    'â—½',
    'â—¼ï¸',
    'â—»ï¸',
    'ğŸŸ¥',
    'ğŸŸ§',
    'ğŸŸ¨',
    'ğŸŸ©',
    'ğŸŸ¦',
    'ğŸŸª',
    'â¬›ï¸',
    'â¬œï¸',
    'ğŸŸ«',
    'ğŸ”ˆ',
    'ğŸ”‡',
    'ğŸ”‰',
    'ğŸ”Š',
    'ğŸ””',
    'ğŸ”•',
    'ğŸ’¬',
    'ğŸ’­',
    'ğŸ—¯',
    'ğŸ•',
    'ğŸ•‘',
    'ğŸ•’',
    'ğŸ•“',
    'ğŸ•”',
    'ğŸ••',
    'ğŸ•–',
    'ğŸ•—',
    'ğŸ•˜',
    'ğŸ•™',
    'ğŸ•š',
    'ğŸ•›',
    'ğŸ•œ',
    'ğŸ•',
    'ğŸ•',
    'ğŸ•Ÿ',
    'ğŸ• ',
    'ğŸ•¡',
    'ğŸ•¢',
    'ğŸ•£',
    'ğŸ•¤',
    'ğŸ•¥',
    'ğŸ•¦',
    'ğŸ•§'
  ])

  const usedEmojis = new Set<string>()

  while (usedEmojis.size < count) {
    const candidate = emoji.random().emoji
    const codePoints = Array.from(candidate).map((ch) => ch.codePointAt(0)!)

    const isCountryFlag = codePoints.length === 2 && codePoints.every((cp) => cp >= 0x1f1e6 && cp <= 0x1f1ff)

    if (
      blockedSkinToneRegex.test(candidate) ||
      isCountryFlag ||
      blockedEmojis.has(candidate) ||
      usedEmojis.has(candidate)
    ) {
      continue
    }

    usedEmojis.add(candidate)
  }

  return Array.from(usedEmojis).join('')
}

export function useRandomEmojis(count: number = 1): string {
  const [emojis, setEmojis] = useState('')

  useEffect(() => {
    setEmojis(generateRandomEmojis(count))
  }, [count])

  return emojis
}
